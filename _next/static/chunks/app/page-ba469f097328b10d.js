(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1033:(e,t,a)=>{Promise.resolve().then(a.bind(a,4369))},3580:(e,t,a)=>{"use strict";a.d(t,{dj:()=>p});var r=a(2115);let n=0,s=new Map,i=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],c={toasts:[]};function d(e){c=l(c,e),o.forEach(e=>{e(c)})}function u(e){let{...t}=e,a=(n=(n+1)%Number.MAX_VALUE).toString(),r=()=>d({type:"DISMISS_TOAST",toastId:a});return d({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function p(){let[e,t]=r.useState(c);return r.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},3999:(e,t,a)=>{"use strict";a.d(t,{cn:()=>s});var r=a(2596),n=a(9688);function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,r.$)(t))}},4369:(e,t,a)=>{"use strict";a.d(t,{BeatSequencer:()=>en});var r=a(5155),n=a(5339),s=a(1362),i=a(2115);let l=[{name:"Kick",key:"A"},{name:"Snare",key:"B"},{name:"Hi-hat",key:"C"},{name:"Clap",key:"D"},{name:"Tom",key:"E"}],o=["rgb(239, 68, 68)","rgb(249, 115, 22)","rgb(59, 130, 246)","rgb(16, 185, 129)","rgb(168, 85, 247)"],c=Array(l.length).fill(null).map(()=>Array(16).fill(!1)),d=l.map(()=>({volume:0,pitch:0,reverb:0,delay:0,noise:0,effectsOn:!1}));function u(e){let{pattern:t,currentStep:a,isPlaying:n,theme:s,isMobile:c,onToggleStep:d}=e,u=(0,i.useRef)(null),p=(0,i.useRef)(!1);(0,i.useEffect)(()=>{let e=u.current;if(!e)return;let r=e.getContext("2d");if(!r)return;let i=e.width,c=e.height,d=i/2,p=c/2,h=.8*Math.min(d,p);r.clearRect(0,0,i,c),r.fillStyle="dark"===s?"#1a1a1a":"#f5f5f5",r.fillRect(0,0,i,c),r.strokeStyle="dark"===s?"#333":"#ddd",r.lineWidth=2,r.beginPath(),r.arc(d,p,h,0,2*Math.PI),r.stroke();for(let e=0;e<16;e++){let t=e/16*Math.PI*2-Math.PI/2;r.strokeStyle=e%4==0?"dark"===s?"#666":"#999":"dark"===s?"#333":"#ddd",r.lineWidth=e%4==0?2:1,r.beginPath(),r.moveTo(d,p),r.lineTo(d+Math.cos(t)*h,p+Math.sin(t)*h),r.stroke(),r.fillStyle="dark"===s?"#999":"#666",r.font="16px sans-serif",r.textAlign="center",r.textBaseline="middle";let a=1.08*h;r.fillText((e+1).toString(),d+Math.cos(t)*a,p+Math.sin(t)*a)}for(let e=0;e<l.length;e++){let i=h*(.9-.15*e);r.strokeStyle="dark"===s?"#444":"#ccc",r.lineWidth=1,r.beginPath(),r.arc(d,p,i,0,2*Math.PI),r.stroke(),r.fillStyle=o[e],r.font="18px sans-serif",r.textAlign="center",r.textBaseline="middle",r.fillText("".concat(l[e].name," (").concat(l[e].key,")"),d,p-i);for(let l=0;l<16;l++){let c=l/16*Math.PI*2-Math.PI/2,u=d+Math.cos(c)*i,h=p+Math.sin(c)*i;t[e][l]?(r.fillStyle=o[e],r.beginPath(),r.arc(u,h,14,0,2*Math.PI),r.fill(),n&&l===a&&(r.fillStyle="rgba(255, 255, 255, 0.5)",r.beginPath(),r.arc(u,h,18,0,2*Math.PI),r.fill())):(r.fillStyle="dark"===s?"#333":"#ddd",r.beginPath(),r.arc(u,h,12,0,2*Math.PI),r.fill(),r.strokeStyle=o[e],r.lineWidth=1,r.beginPath(),r.arc(u,h,12,0,2*Math.PI),r.stroke())}}if(n){let e=a/16*Math.PI*2-Math.PI/2;r.strokeStyle="dark"===s?"#fff":"#000",r.lineWidth=2,r.beginPath(),r.moveTo(d,p),r.lineTo(d+Math.cos(e)*h,p+Math.sin(e)*h),r.stroke(),r.fillStyle="dark"===s?"#fff":"#000",r.beginPath(),r.arc(d+Math.cos(e)*h,p+Math.sin(e)*h,5,0,2*Math.PI),r.fill()}},[a,n,t,s]);let h=(e,t)=>{let a=u.current;if(!a)return;let r=a.getBoundingClientRect(),n=a.width/r.width,s=a.height/r.height,i=(e-r.left)*n,o=(t-r.top)*s,p=a.width/2,h=a.height/2,f=.8*Math.min(p,h),m=i-p,g=o-h,x=Math.sqrt(m*m+g*g),v=Math.atan2(g,m)+Math.PI/2;v<0&&(v+=2*Math.PI);let y=Math.round(v/(2*Math.PI)*16)%16;for(let e=0;e<l.length;e++){let t=f*(.9-.15*e),a=c?30:20,r=t-a,n=t+a;if(x>=r&&x<=n){d(e,y);return}}};return(0,r.jsx)("canvas",{ref:u,width:800,height:800,className:"w-full max-w-[800px] h-auto cursor-pointer touch-none",onClick:e=>{c||h(e.clientX,e.clientY)},onTouchStart:e=>{if(e.preventDefault(),p.current=!0,0===e.touches.length)return;let t=e.touches[0];h(t.clientX,t.clientY)},onTouchEnd:e=>{e.preventDefault(),p.current=!1},onTouchMove:e=>{p.current&&e.preventDefault()}})}var p=a(9708),h=a(2085),f=a(3999);let m=(0,h.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),g=i.forwardRef((e,t)=>{let{className:a,variant:n,size:s,asChild:i=!1,...l}=e,o=i?p.DX:"button";return(0,r.jsx)(o,{className:(0,f.cn)(m({variant:n,size:s,className:a})),ref:t,...l})});g.displayName="Button";var x=a(2178),v=a(5690),y=a(4021),b=a(2525),k=a(4229),w=a(1788),j=a(9869),N=a(5517),C=a(227);function S(e){let{isPlaying:t,samplesLoaded:a,onTogglePlay:n,onUndo:s,canUndo:i,onClear:l,onSave:o,onShare:c,onLoad:d,onExportWav:u,onExportMidi:p}=e;return(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 justify-center",children:[(0,r.jsxs)(g,{onClick:n,className:"flex items-center gap-2 p-6 text-lg",disabled:!a,children:[t?(0,r.jsx)(x.A,{className:"h-6 w-6"}):(0,r.jsx)(v.A,{className:"h-6 w-6"}),t?"Pause":"Play"]}),(0,r.jsxs)(g,{onClick:s,variant:"outline",className:"p-4 text-md",disabled:!i,children:[(0,r.jsx)(y.A,{className:"h-5 w-5 mr-2"}),"Undo"]}),(0,r.jsxs)(g,{onClick:l,variant:"outline",className:"p-4 text-md",children:[(0,r.jsx)(b.A,{className:"h-5 w-5 mr-2"}),"Clear"]}),(0,r.jsxs)(g,{onClick:o,variant:"outline",className:"p-4 text-md",children:[(0,r.jsx)(k.A,{className:"h-5 w-5 mr-2"}),"Save"]}),(0,r.jsxs)(g,{onClick:c,variant:"outline",className:"p-4 text-md",children:[(0,r.jsx)(w.A,{className:"h-5 w-5 mr-2"}),"Share URL"]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(g,{variant:"outline",asChild:!0,className:"cursor-pointer p-4 text-md",children:(0,r.jsxs)("label",{htmlFor:"load-pattern",className:"flex items-center",children:[(0,r.jsx)(j.A,{className:"h-5 w-5 mr-2"}),"Load"]})}),(0,r.jsx)("input",{id:"load-pattern",type:"file",accept:".json",className:"sr-only",onChange:d})]}),(0,r.jsxs)(g,{onClick:u,variant:"outline",className:"p-4 text-md",children:[(0,r.jsx)(N.A,{className:"h-5 w-5 mr-2"}),"Export WAV"]}),(0,r.jsxs)(g,{onClick:p,variant:"outline",className:"p-4 text-md",children:[(0,r.jsx)(C.A,{className:"h-5 w-5 mr-2"}),"Export MIDI"]})]})}var A=a(9628);let R=i.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsxs)(A.bL,{ref:t,className:(0,f.cn)("relative flex w-full touch-action-pan-x select-none items-center",a),...n,children:[(0,r.jsx)(A.CC,{className:"relative h-4 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,r.jsx)(A.Q6,{className:"absolute h-full bg-primary"})}),(0,r.jsx)(A.zi,{className:"block h-8 w-8 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});function E(e){let{tempo:t,onTempoChange:a}=e;return(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsxs)("span",{className:"text-sm font-medium",children:["Tempo: ",t," BPM"]})}),(0,r.jsx)(R,{value:[t],min:60,max:200,step:1,onValueChange:e=>a(e[0])})]})}function T(e){let{swing:t,onSwingChange:a}=e;return(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsxs)("span",{className:"text-sm font-medium",children:["Swing: ",t,"%"]})}),(0,r.jsx)(R,{value:[t],min:0,max:50,step:1,onValueChange:e=>a(e[0])})]})}R.displayName=A.bL.displayName;var M=a(4839),I=a(6474),P=a(7863),O=a(5196);let D=M.bL;M.YJ;let L=M.WT,U=i.forwardRef((e,t)=>{let{className:a,children:n,...s}=e;return(0,r.jsxs)(M.l9,{ref:t,className:(0,f.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...s,children:[n,(0,r.jsx)(M.In,{asChild:!0,children:(0,r.jsx)(I.A,{className:"h-4 w-4 opacity-50"})})]})});U.displayName=M.l9.displayName;let z=i.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(M.PP,{ref:t,className:(0,f.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,r.jsx)(P.A,{className:"h-4 w-4"})})});z.displayName=M.PP.displayName;let V=i.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(M.wn,{ref:t,className:(0,f.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,r.jsx)(I.A,{className:"h-4 w-4"})})});V.displayName=M.wn.displayName;let _=i.forwardRef((e,t)=>{let{className:a,children:n,position:s="popper",...i}=e;return(0,r.jsx)(M.ZL,{children:(0,r.jsxs)(M.UC,{ref:t,className:(0,f.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:s,...i,children:[(0,r.jsx)(z,{}),(0,r.jsx)(M.LM,{className:(0,f.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,r.jsx)(V,{})]})})});_.displayName=M.UC.displayName,i.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(M.JU,{ref:t,className:(0,f.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...n})}).displayName=M.JU.displayName;let q=i.forwardRef((e,t)=>{let{className:a,children:n,...s}=e;return(0,r.jsxs)(M.q7,{ref:t,className:(0,f.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...s,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(M.VF,{children:(0,r.jsx)(O.A,{className:"h-4 w-4"})})}),(0,r.jsx)(M.p4,{children:n})]})});function W(e){let{selectedKit:t,kits:a,onKitChange:n}=e;return(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsx)("span",{className:"text-sm font-medium",children:"Drum Kit"})}),(0,r.jsxs)(D,{value:t,onValueChange:n,children:[(0,r.jsx)(U,{children:(0,r.jsx)(L,{placeholder:"Select a kit"})}),(0,r.jsx)(_,{children:a.map(e=>(0,r.jsx)(q,{value:e,children:e},e))})]})]})}q.displayName=M.q7.displayName,i.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(M.wv,{ref:t,className:(0,f.cn)("-mx-1 my-1 h-px bg-muted",a),...n})}).displayName=M.wv.displayName;var F=a(1028);let B=i.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(F.bL,{className:(0,f.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...n,ref:t,children:(0,r.jsx)(F.zi,{className:(0,f.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});function K(e){let{metronome:t,quantize:a,onMetronomeChange:n,onQuantizeChange:s}=e;return(0,r.jsxs)("div",{className:"flex flex-wrap gap-6 justify-center",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(B,{id:"metronome",checked:t,onCheckedChange:n}),(0,r.jsx)("label",{htmlFor:"metronome",className:"text-sm font-medium",children:"Metronome"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(B,{id:"quantize",checked:a,onCheckedChange:s}),(0,r.jsx)("label",{htmlFor:"quantize",className:"text-sm font-medium",children:"Quantize"})]})]})}function J(e){let{trackSettings:t,handleTrackSettingChange:a,samples:n,trackColors:s}=e;return(0,r.jsxs)("div",{className:"grid gap-6 mt-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-center",children:"Mixer"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:n.map((e,n)=>(0,r.jsxs)("div",{className:"grid gap-3 p-4 rounded-lg",style:{backgroundColor:"".concat(s[n],"33")},children:[(0,r.jsx)("span",{className:"text-sm font-bold",style:{color:s[n]},children:e.name}),(0,r.jsxs)("div",{className:"grid gap-1",children:[(0,r.jsx)("label",{className:"text-xs",children:"Volume"}),(0,r.jsx)(R,{value:[t[n].volume],min:-24,max:6,step:1,onValueChange:e=>a(n,"volume",e[0])}),(0,r.jsxs)("span",{className:"text-xs text-center",children:[t[n].volume.toFixed(1)," dB"]})]}),(0,r.jsxs)("div",{className:"grid gap-1",children:[(0,r.jsx)("label",{className:"text-xs",children:"Pitch"}),(0,r.jsx)(R,{value:[t[n].pitch],min:-1200,max:1200,step:50,onValueChange:e=>a(n,"pitch",e[0])}),(0,r.jsxs)("span",{className:"text-xs text-center",children:[t[n].pitch," cents"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(B,{id:"effectsOn-".concat(n),checked:t[n].effectsOn,onCheckedChange:e=>a(n,"effectsOn",e),className:"transform scale-125"}),(0,r.jsx)("label",{htmlFor:"effectsOn-".concat(n),className:"text-sm pl-2",children:"Effects"})]}),(0,r.jsxs)("div",{className:"grid gap-1",children:[(0,r.jsx)("label",{className:"text-xs",children:"Reverb"}),(0,r.jsx)(R,{value:[t[n].reverb],min:0,max:1,step:.01,onValueChange:e=>a(n,"reverb",e[0]),disabled:!t[n].effectsOn})]}),(0,r.jsxs)("div",{className:"grid gap-1",children:[(0,r.jsx)("label",{className:"text-xs",children:"Echo"}),(0,r.jsx)(R,{value:[t[n].delay],min:0,max:1,step:.01,onValueChange:e=>a(n,"delay",e[0]),disabled:!t[n].effectsOn})]}),(0,r.jsxs)("div",{className:"grid gap-1",children:[(0,r.jsx)("label",{className:"text-xs",children:"Noise"}),(0,r.jsx)(R,{value:[t[n].noise],min:0,max:1,step:.01,onValueChange:e=>a(n,"noise",e[0]),disabled:!t[n].effectsOn})]})]},n))})]})}B.displayName=F.bL.displayName;var G=a(2098),Y=a(3509);function H(){let{theme:e,setTheme:t}=(0,s.D)(),[a,n]=i.useState(!1);return(i.useEffect(()=>{n(!0)},[]),a)?(0,r.jsxs)(g,{variant:"outline",size:"icon",onClick:()=>t("dark"===e?"light":"dark"),children:[(0,r.jsx)(G.A,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,r.jsx)(Y.A,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,r.jsx)("span",{className:"sr-only",children:"Toggle theme"})]}):(0,r.jsxs)(g,{variant:"outline",size:"icon",disabled:!0,children:[(0,r.jsx)(G.A,{className:"h-[1.2rem] w-[1.2rem]"}),(0,r.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}var Q=a(9194),X=a(9959),Z=a(3580);let $={Default:{Kick:{type:"MembraneSynth",options:{pitchDecay:.05,octaves:10,oscillator:{type:"sine"},envelope:{attack:.001,decay:.4,sustain:.01,release:1.4,attackCurve:"exponential"}}},Snare:{type:"NoiseSynth",options:{noise:{type:"white",playbackRate:2},envelope:{attack:.001,decay:.2,sustain:.1,release:.1}}},"Hi-hat":{type:"NoiseSynth",options:{noise:{type:"white",playbackRate:1},envelope:{attack:.001,decay:.1,sustain:.01,release:.03}}},Clap:{type:"NoiseSynth",options:{noise:{type:"pink",playbackRate:.5},envelope:{attack:.001,decay:.05,sustain:.3,release:.1}}},Tom:{type:"MembraneSynth",options:{pitchDecay:.008,octaves:4,oscillator:{type:"sine"},envelope:{attack:.001,decay:.5,sustain:.01,release:1,attackCurve:"exponential"}}}},606:{Kick:{type:"MembraneSynth",options:{pitchDecay:.02,octaves:6,oscillator:{type:"sine"},envelope:{attack:.001,decay:.2,sustain:.01,release:.8,attackCurve:"exponential"}}},Snare:{type:"NoiseSynth",options:{noise:{type:"white"},envelope:{attack:.001,decay:.1,sustain:.01,release:.1}}},"Hi-hat":{type:"MetalSynth",options:{frequency:250,envelope:{attack:.001,decay:.2,release:.1},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5}},Clap:{type:"NoiseSynth",options:{noise:{type:"white"},envelope:{attack:.001,decay:.05,sustain:.1,release:.1}}},Tom:{type:"MembraneSynth",options:{pitchDecay:.01,octaves:3,oscillator:{type:"sine"},envelope:{attack:.001,decay:.3,sustain:.01,release:.8,attackCurve:"exponential"}}}},808:{Kick:{type:"MembraneSynth",options:{pitchDecay:.05,octaves:10,oscillator:{type:"sine"},envelope:{attack:.001,decay:.4,sustain:.01,release:1.4,attackCurve:"exponential"}}},Snare:{type:"NoiseSynth",options:{noise:{type:"white"},envelope:{attack:.001,decay:.2,sustain:0,release:.1}}},"Hi-hat":{type:"MetalSynth",options:{frequency:200,envelope:{attack:.001,decay:.1,release:.05},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5}},Clap:{type:"NoiseSynth",options:{noise:{type:"white"},envelope:{attack:.001,decay:.1,sustain:0,release:.1}}},Tom:{type:"MembraneSynth",options:{pitchDecay:.05,octaves:10,oscillator:{type:"sine"},envelope:{attack:.001,decay:.4,sustain:.01,release:1.4,attackCurve:"exponential"}}}},909:{Kick:{type:"MembraneSynth",options:{pitchDecay:.01,octaves:6,oscillator:{type:"sine"},envelope:{attack:.001,decay:.2,sustain:.01,release:.8,attackCurve:"exponential"}}},Snare:{type:"NoiseSynth",options:{noise:{type:"white"},envelope:{attack:.001,decay:.1,sustain:0,release:.1}}},"Hi-hat":{type:"MetalSynth",options:{frequency:250,envelope:{attack:.001,decay:.05,release:.05},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5}},Clap:{type:"NoiseSynth",options:{noise:{type:"white"},envelope:{attack:.001,decay:.1,sustain:0,release:.1}}},Tom:{type:"MembraneSynth",options:{pitchDecay:.01,octaves:6,oscillator:{type:"sine"},envelope:{attack:.001,decay:.2,sustain:.01,release:.8,attackCurve:"exponential"}}}}},ee=e=>e.map(e=>[...e]),et=e=>{let t="";for(let a=0;a<e.length;a+=32768)t+=String.fromCharCode(...e.subarray(a,a+32768));return btoa(t)},ea=e=>{let t=atob(e),a=new Uint8Array(t.length);for(let e=0;e<t.length;e++)a[e]=t.charCodeAt(e);return a},er=e=>{if("undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);let t="";return e.forEach(e=>{t+=String.fromCharCode(e)}),t};function en(){let{theme:e}=(0,s.D)(),t=function(){let[e,t]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let e=()=>{let e=navigator.userAgent||navigator.vendor||window.opera;t(/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e.toLowerCase())||window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}(),{isPlaying:a,currentStep:p,tempo:h,setTempo:f,swing:m,setSwing:g,selectedKit:x,setSelectedKit:v,metronome:y,setMetronome:b,quantize:k,setQuantize:w,pattern:j,toggleStep:N,trackSettings:C,handleTrackSettingChange:A,historyIndex:R,samplesLoaded:M,loadingError:I,togglePlay:P,handleUndo:O,handleClear:D,savePattern:L,loadPattern:U,sharePattern:z,exportWAV:V,exportMIDI:_}=function(e){let{isMobile:t}=e,[a,r]=(0,i.useState)(!1),[n,s]=(0,i.useState)(0),o=(0,i.useRef)(0),[u,p]=(0,i.useState)(110),h=(0,i.useRef)(110),[f,m]=(0,i.useState)(0),g=(0,i.useRef)(0),[x,v]=(0,i.useState)("Default"),[y,b]=(0,i.useState)(!1),[k,w]=(0,i.useState)(!0),[j,N]=(0,i.useState)(ee(c)),[C,S]=(0,i.useState)(d.map(e=>({...e}))),[A,R]=(0,i.useState)([ee(c)]),[E,T]=(0,i.useState)(0),M=(0,i.useRef)(0),I=(0,i.useRef)([ee(c)]),{toast:P}=(0,Z.dj)(),O=(0,i.useRef)({}),D=(0,i.useRef)({}),L=(0,i.useRef)(null),[U,z]=(0,i.useState)(!1),[V,_]=(0,i.useState)(null);(0,i.useEffect)(()=>{o.current=n},[n]),(0,i.useEffect)(()=>{M.current=E},[E]),(0,i.useEffect)(()=>{I.current=A},[A]),(0,i.useEffect)(()=>{g.current=f,Q.Transport.swing=f/100,Q.Transport.swingSubdivision="16n"},[f]),(0,i.useEffect)(()=>{h.current=u,Q.Transport.bpm.value=u},[u]),(0,i.useEffect)(()=>{if(!U)return;let e=$[x];C.forEach((t,a)=>{let r=l[a],n=r.name.toLowerCase(),s=O.current[n];if(s){s.volume.value=t.volume;let a=t.pitch;if(s.detune)s.detune.value=a;else if(s instanceof Q.NoiseSynth){var i,o;let t=e[r.name],n=(null==t?void 0:null===(o=t.options)||void 0===o?void 0:null===(i=o.noise)||void 0===i?void 0:i.playbackRate)||1;s.noise.playbackRate=n*2**(a/1200)}}})},[C,U,x]),(0,i.useEffect)(()=>{U&&C.forEach((e,t)=>{let a=l[t].name.toLowerCase(),r=D.current[a];r&&(r.reverb.wet.value=e.effectsOn?e.reverb:0,r.delay.wet.value=e.effectsOn?e.delay:0,r.noise.gain.value=e.effectsOn?e.noise:0)})},[C,U]),(0,i.useEffect)(()=>{var e;let t="started"===Q.Transport.state,a=Q.Transport.position,n=(null===(e=L.current)||void 0===e?void 0:e.state)==="started",i=(o.current+1)%16;t&&Q.Transport.pause();let c=!0;return z(!1),_(null),(async()=>{try{if(!c)return;Q.Transport.cancel(),L.current&&L.current.dispose(),Object.values(O.current).forEach(e=>e.dispose()),Object.values(D.current).forEach(e=>{Object.values(e).forEach(e=>e.dispose())}),Q.Transport.bpm.value=h.current,Q.Transport.swing=g.current/100;let e={},o={},d=$[x];if(l.forEach(t=>{let a=t.name.toLowerCase(),r=d[t.name];if(r){let t=Q[r.type];if("function"==typeof t){let n=new t(r.options),s=new Q.Reverb({decay:1.5,wet:0}),i=new Q.FeedbackDelay("8n",.25);i.wet.value=0;let l=new Q.Noise("white").start(),c=new Q.Gain(0);l.connect(c),n.chain(s,i,Q.Destination),c.toDestination(),e[a]=n,o[a]={reverb:s,delay:i,noise:c,noiseSource:l}}}}),e.metronome=new Q.Synth().toDestination(),!c)return;if(O.current=e,D.current=o,L.current=new Q.Sequence((e,t)=>{if(c&&(s(t),j.forEach((a,r)=>{if(a[t]){let t=l[r].name.toLowerCase(),a=O.current[t];if(a)try{"kick"===t?a.triggerAttackRelease("C1","8n",e):"snare"===t?a.triggerAttackRelease("8n",e):"hi-hat"===t?a.triggerAttackRelease("32n",e):"clap"===t?a.triggerAttackRelease("8n",e):"tom"===t&&a.triggerAttackRelease("G2","8n",e)}catch(e){}}}),y&&t%4==0)){var a;null===(a=O.current.metronome)||void 0===a||a.triggerAttackRelease("C5","32n",e)}},Array.from({length:16},(e,t)=>t),"16n"),c&&(z(!0),_(null)),c&&t&&n)try{L.current&&"started"!==L.current.state&&L.current.start(0,i),Q.Transport.start("+0",a)}catch(e){console.error("Error resuming playback:",e),r(!1)}}catch(e){c&&(_(e instanceof Error?e.message:"Failed to initialize audio"),z(!0))}})(),()=>{c=!1,L.current&&L.current.dispose(),Object.values(O.current).forEach(e=>{e&&!e.disposed&&e.dispose()}),Object.values(D.current).forEach(e=>{Object.values(e).forEach(e=>{e&&!e.disposed&&e.dispose()})})}},[x]),(0,i.useEffect)(()=>{if(L.current&&U)try{L.current.callback=(e,t)=>{if(s(t),j.forEach((a,r)=>{if(a[t]){let t=l[r].name.toLowerCase(),a=O.current[t];if(a)try{"kick"===t?a.triggerAttackRelease("C1","8n",e):"snare"===t?a.triggerAttackRelease("8n",e):"hi-hat"===t?a.triggerAttackRelease("32n",e):"clap"===t?a.triggerAttackRelease("8n",e):"tom"===t&&a.triggerAttackRelease("G2","8n",e)}catch(e){console.warn("Error playing ".concat(t,":"),e)}}}),y&&t%4==0){let t=O.current.metronome;if(t)try{t.triggerAttackRelease("C5","32n",e)}catch(e){console.warn("Error playing metronome:",e)}}}}catch(e){console.error("Error updating sequence callback:",e)}},[j,y,U]);let q=(0,i.useCallback)(e=>{R(t=>{let a=[...t.slice(0,M.current+1),ee(e)];return I.current=a,M.current=a.length-1,a}),T(M.current)},[]),W=(0,i.useCallback)(async()=>{if(!U){P({title:"Audio not ready",description:"Please wait for audio to initialize.",variant:"destructive"});return}if(a)try{"started"===Q.Transport.state&&Q.Transport.pause(),r(!1)}catch(e){console.error("Error stopping playback:",e),r(!1)}else try{if("running"!==Q.context.state)try{await Q.start()}catch(e){console.error("Error starting audio context:",e),P({title:"Audio Context Error",description:"Could not start audio. Try clicking play again.",variant:"destructive"});return}if(L.current&&"started"!==L.current.state)try{L.current.start(0)}catch(e){console.error("Error starting sequence:",e),P({title:"Sequence Error",description:"Could not start the beat sequence.",variant:"destructive"});return}if("started"!==Q.Transport.state)try{Q.Transport.start()}catch(e){console.error("Error starting transport:",e),P({title:"Transport Error",description:"Could not start the audio transport.",variant:"destructive"});return}r(!0)}catch(e){console.error("Error starting playback:",e),P({title:"Playback error",description:"There was an error starting playback.",variant:"destructive"})}},[a,U,P]),F=(0,i.useCallback)(()=>{let e=ee(c);N(e),q(e)},[q]),B=(0,i.useCallback)(()=>{if(M.current>0){let e=M.current-1;M.current=e,T(e);let t=I.current[e];t&&N(ee(t))}},[]),K=(0,i.useCallback)((e,r)=>{let n=j.map((t,a)=>a===e?t.map((e,t)=>t===r?!e:e):[...t]);if(N(n),q(n),!a&&U){let t=l[e].name.toLowerCase(),a=O.current[t];a&&("kick"===t?a.triggerAttackRelease("C1","8n"):"snare"===t?a.triggerAttackRelease("8n"):"hi-hat"===t?a.triggerAttackRelease("32n"):"clap"===t?a.triggerAttackRelease("8n"):"tom"===t&&a.triggerAttackRelease("G2","8n"))}if(t&&"vibrate"in navigator)try{navigator.vibrate(50)}catch(e){}},[q,t,a,j,U]),J=(0,i.useCallback)(()=>{let e=JSON.stringify({pattern:j,tempo:u,swing:f,selectedKit:x,metronome:y,quantize:k,trackSettings:C}),t="data:text/json;charset=utf-8,".concat(encodeURIComponent(e)),a=document.createElement("a");a.href=t,a.download="beat-pattern.json",a.click(),P({title:"Pattern saved",description:"Your beat pattern has been saved as a JSON file."})},[y,j,k,x,f,u,P,C]),G=(0,i.useCallback)(e=>{var t,a,r,n,s;if(!e||!e.pattern)return;N(ee(e.pattern)),p(null!==(t=e.tempo)&&void 0!==t?t:110),m(null!==(a=e.swing)&&void 0!==a?a:0),v(null!==(r=e.selectedKit)&&void 0!==r?r:"Default"),b(null!==(n=e.metronome)&&void 0!==n&&n),w(null===(s=e.quantize)||void 0===s||s),S(e.trackSettings?e.trackSettings.map((e,t)=>({...d[t]||{},...e})):d.map(e=>({...e})));let i=[ee(e.pattern)];I.current=i,M.current=0,R(i),T(0)},[]),Y=(0,i.useCallback)(e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;let r=new FileReader;r.onload=e=>{try{var t;let a=JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result);G(a),P({title:"Pattern loaded",description:"Your beat pattern has been loaded successfully."})}catch(e){P({title:"Error loading pattern",description:"The file could not be parsed as a valid pattern.",variant:"destructive"})}},r.readAsText(a),e.target.value=""},[G,P]),H=(0,i.useCallback)((e,t,a)=>{let r=[...C];r[e]={...r[e],[t]:a},S(r)},[C]),en=(0,i.useCallback)(()=>{let e=JSON.stringify({pattern:j,tempo:u,swing:f,selectedKit:x,metronome:y,quantize:k,trackSettings:C}),t=et(X.Ay.deflate(e)),a="".concat(window.location.origin).concat(window.location.pathname,"?pattern=").concat(encodeURIComponent(t));navigator.clipboard.writeText(a).then(()=>{P({title:"URL copied to clipboard",description:"Share this URL to let others play your beat pattern."})})},[y,j,k,x,f,u,P,C]),es=(0,i.useCallback)(e=>{let t=e.length,a=e.numberOfChannels,r=e.sampleRate,n=2*a,s=t*n,i=44+s,l=new ArrayBuffer(i),o=new DataView(l),c=(e,t)=>{for(let a=0;a<t.length;a++)o.setUint8(e+a,t.charCodeAt(a))};c(0,"RIFF"),o.setUint32(4,i-8,!0),c(8,"WAVE"),c(12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,a,!0),o.setUint32(24,r,!0),o.setUint32(28,r*n,!0),o.setUint16(32,n,!0),o.setUint16(34,16,!0),c(36,"data"),o.setUint32(40,s,!0);let d=44;for(let r=0;r<t;r++)for(let t=0;t<a;t++){let a=Math.max(-1,Math.min(1,e.getChannelData(t)[r]));o.setInt16(d,32767*a,!0),d+=2}return l},[]),ei=(0,i.useCallback)(async()=>{if(!U){P({title:"Audio not ready",description:"Please wait for audio to initialize before exporting.",variant:"destructive"});return}try{let e=60/u/4*16,t=[],a=await Q.Offline(()=>{var a;Q.Transport.cancel(),Q.Transport.bpm.value=u,Q.Transport.swing=f/100,Q.Transport.swingSubdivision="16n",Q.Transport.position=0;let r=null!==(a=$[x])&&void 0!==a?a:$.Default,n={};l.forEach((a,s)=>{let i=a.name.toLowerCase(),l=r[a.name];if(!l)return;let o=Q[l.type];if("function"!=typeof o)return;let c=new o(l.options),d=new Q.Reverb({decay:1.5,wet:0}),u=new Q.FeedbackDelay("8n",.25);u.wet.value=0;let p=new Q.Noise("white").start(0),h=new Q.Gain(0);p.connect(h),h.toDestination(),c.chain(d,u,Q.Destination),t.push(c,d,u,p,h);let f=C[s];if(f){c.volume.value=f.volume;let e=f.pitch;if("detune"in c&&c.detune)c.detune.value=e;else if(c instanceof Q.NoiseSynth){var m,g,x;let t=null!==(x=null===(g=l.options)||void 0===g?void 0:null===(m=g.noise)||void 0===m?void 0:m.playbackRate)&&void 0!==x?x:1;c.noise.playbackRate=t*2**(e/1200)}d.wet.value=f.effectsOn?f.reverb:0,u.wet.value=f.effectsOn?f.delay:0,h.gain.value=f.effectsOn?f.noise:0}n[i]=c,p.stop(e)});let s=new Q.Sequence((e,t)=>{j.forEach((a,r)=>{if(!a[t])return;let s=l[r].name.toLowerCase(),i=n[s];if(i)try{"kick"===s?i.triggerAttackRelease("C1","8n",e):"snare"===s?i.triggerAttackRelease("8n",e):"hi-hat"===s?i.triggerAttackRelease("32n",e):"clap"===s?i.triggerAttackRelease("8n",e):"tom"===s&&i.triggerAttackRelease("G2","8n",e)}catch(e){console.warn("Error triggering ".concat(s," during export:"),e)}})},Array.from({length:16},(e,t)=>t),"16n");t.push(s),s.start(0),Q.Transport.start(0)},e);t.forEach(e=>{try{e&&"function"==typeof e.dispose&&!e.disposed&&e.dispose()}catch(e){console.warn("Error disposing offline node:",e)}});let r=es(a),n=new Blob([r],{type:"audio/wav"}),s=URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download="beat-pattern.wav",i.click(),URL.revokeObjectURL(s),P({title:"WAV exported",description:"Your beat pattern has been exported as a WAV file."})}catch(e){console.error("Error exporting WAV:",e),P({title:"Export error",description:"There was an error exporting the WAV file.",variant:"destructive"})}},[es,j,U,x,f,u,P,C]),el=(0,i.useCallback)(e=>{if(0===e)return[0];let t=[];for(t.unshift(127&e),e>>=7;e>0;)t.unshift(127&e|128),e>>=7;return t},[]),eo=(0,i.useCallback)(()=>{try{let e={kick:36,snare:38,"hi-hat":42,clap:39,tom:45},t=[],a=Math.round(6e7/u);t.push(0,255,81,3,a>>16&255,a>>8&255,255&a);let r=0;for(let a=0;a<16;a++){let n=120*a,s=!1;j.forEach((i,o)=>{if(i[a]){let a=e[l[o].name.toLowerCase()],i=s?0:n-r;t.push(...el(i),153,a,100),s=!0,t.push(...el(60),137,a,0),r=n+60}})}t.push(0,255,47,0);let n=t.length,s=new Uint8Array(22+n),i=0;s.set([77,84,104,100],i),i+=4,s.set([0,0,0,6],i),i+=4,s.set([0,1],i),i+=2,s.set([0,1],i),i+=2,s.set([1,224],i),i+=2,s.set([77,84,114,107],i),i+=4,s.set([n>>24&255,n>>16&255,n>>8&255,255&n],i),i+=4,s.set(t,i);let o=new Blob([s],{type:"audio/midi"}),c=URL.createObjectURL(o),d=document.createElement("a");d.href=c,d.download="beat-pattern.mid",document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c),P({title:"MIDI exported",description:"Your beat pattern has been exported as a MIDI file."})}catch(e){console.error("Error exporting MIDI:",e),P({title:"Export error",description:"There was an error exporting the MIDI file.",variant:"destructive"})}},[el,j,u,P]);return(0,i.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("pattern");if(e)try{let t;let a=decodeURIComponent(e);try{let e;let r=ea(a);try{e=X.Ay.inflate(r)}catch(t){e=r}t=er(e)}catch(e){t=a}let r=JSON.parse(t);G(r),P({title:"Pattern loaded from URL",description:"A shared beat pattern has been loaded."})}catch(e){console.error("Error loading pattern from URL",e),P({title:"Error loading pattern from URL",description:"The shared URL is invalid or corrupted.",variant:"destructive"})}},[G,P]),(0,i.useEffect)(()=>{let e=e=>{let t=e.key.toUpperCase(),r=l.findIndex(e=>e.key===t);if(-1!==r&&U){let e=l[r].name.toLowerCase(),t=O.current[e];t&&("kick"===e?t.triggerAttackRelease("C1","8n"):"snare"===e?t.triggerAttackRelease("8n"):"hi-hat"===e?t.triggerAttackRelease("32n"):"clap"===e?t.triggerAttackRelease("8n"):"tom"===e&&t.triggerAttackRelease("G2","8n")),a&&k&&K(r,n)}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[n,a,k,U,K]),{isPlaying:a,currentStep:n,tempo:u,setTempo:p,swing:f,setSwing:m,selectedKit:x,setSelectedKit:v,metronome:y,setMetronome:b,quantize:k,setQuantize:w,pattern:j,toggleStep:K,trackSettings:C,handleTrackSettingChange:H,historyIndex:E,samplesLoaded:U,loadingError:V,togglePlay:W,handleUndo:B,handleClear:F,savePattern:J,loadPattern:Y,sharePattern:en,exportWAV:ei,exportMIDI:eo}}({isMobile:t}),q=Object.keys($);return(0,r.jsxs)("div",{className:"flex flex-col items-center w-full max-w-4xl",children:[!M&&(0,r.jsx)("div",{className:"mb-4 p-4 bg-muted rounded-lg w-full max-w-[600px]",children:I?(0,r.jsxs)("div",{className:"flex items-center gap-2 text-destructive",children:[(0,r.jsx)(n.A,{className:"h-4 w-4"}),(0,r.jsxs)("p",{children:["Error initializing audio: ",I]})]}):(0,r.jsx)("p",{className:"text-muted-foreground",children:"Initializing synthetic drum sounds..."})}),(0,r.jsx)("div",{className:"relative mb-4 w-full max-w-[800px]",children:(0,r.jsx)(u,{pattern:j,currentStep:p,isPlaying:a,theme:e,isMobile:t,onToggleStep:N})}),(0,r.jsxs)("div",{className:"w-full max-w-[800px] grid gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)(S,{isPlaying:a,samplesLoaded:M,onTogglePlay:P,onUndo:O,canUndo:R>0,onClear:D,onSave:L,onShare:z,onLoad:U,onExportWav:V,onExportMidi:_}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(H,{})})]}),(0,r.jsx)(E,{tempo:h,onTempoChange:f}),(0,r.jsx)(T,{swing:m,onSwingChange:g}),(0,r.jsx)(W,{selectedKit:x,kits:q,onKitChange:v}),(0,r.jsx)(K,{metronome:y,quantize:k,onMetronomeChange:b,onQuantizeChange:w}),(0,r.jsx)(J,{trackSettings:C,handleTrackSettingChange:A,samples:l,trackColors:o}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground mt-4",children:[(0,r.jsxs)("p",{className:"mb-2",children:[(0,r.jsx)("strong",{children:"Instructions:"})," Click on the circles to add/remove beats. Press keyboard keys (A-E) to trigger sounds. All sounds are generated synthetically for reliability."]}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:l.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:o[t]}}),(0,r.jsxs)("span",{children:[e.name," - Key ",e.key]})]},e.name))})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[33,145,880,441,684,358],()=>t(1033)),_N_E=e.O()}]);